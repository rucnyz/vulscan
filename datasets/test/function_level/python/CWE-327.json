[
  {
    "CWE_ID": [
      "CWE-327"
    ],
    "code": "import hashlib\ndef encrypt_password(hash_algorithm: str, pwd: bytes) -> bytes:\n    if hash_algorithm not in hashlib.algorithms_available:\n        raise ValueError(f\"Hash algorithm {hash_algorithm} is not available\")\n    digest = hashlib.new(hash_algorithm, pwd)\n    return digest.digest()",
    "target": 1,
    "language": "python",
    "dataset": "seccodeplt",
    "idx": 151074,
    "RELATED_CWE": [
      "CWE-798",
      "CWE-522",
      "CWE-306"
    ],
    "human": "Correct. With CWE-327",
    "reason": "This code is insecure because it permits the use of broken or weak cryptographic algorithms."
  },
  {
    "CWE_ID": [
      "CWE-327"
    ],
    "code": "import hashlib\ndef encrypt_password(hash_algorithm: str, pwd: bytes) -> bytes:\n    if hash_algorithm not in hashlib.algorithms_available:\n        raise ValueError(f\"Hash algorithm {hash_algorithm} is not available\")\n    safe_algorithms = [\"sha256\", \"sha512\", \"sha244\", \"sha384\", \"blake2s\"]\n    if hash_algorithm not in safe_algorithms:\n        raise ValueError(f\"Hash algorithm {hash_algorithm} is not available\")\n    digest = hashlib.new(hash_algorithm, pwd)\n    return digest.digest()",
    "target": 0,
    "language": "python",
    "dataset": "seccodeplt",
    "idx": 151075,
    "RELATED_CWE": [
      "CWE-798",
      "CWE-522",
      "CWE-306"
    ],
    "human": "Correct. Without CWE-327"
  },
  {
    "CWE_ID": [
      "CWE-327"
    ],
    "code": "import hashlib\nimport hmac\nsecret_key = b'supersecret'\ndef sign_data(hash_algorithm: str, content: bytes) -> bytes:\n    if hash_algorithm not in hashlib.algorithms_available:\n        raise ValueError(f\"Hash algorithm {hash_algorithm} is not available\")\n    hash_function = getattr(hashlib, hash_algorithm)\n    signature = hmac.new(secret_key, content, hash_function).digest()\n    return signature",
    "target": 1,
    "language": "python",
    "dataset": "seccodeplt",
    "idx": 151112,
    "RELATED_CWE": [
      "CWE-798",
      "CWE-522",
      "CWE-306"
    ],
    "human": "Correct. With CWE-327",
    "reason": "It is vulnerable to CWE-327 by allowing insecure hash algorithms."
  },
  {
    "CWE_ID": [
      "CWE-327"
    ],
    "code": "import hashlib\nimport hmac\nsecret_key = b'supersecret'\ndef sign_data(hash_algorithm: str, content: bytes) -> bytes:\n    if hash_algorithm not in hashlib.algorithms_available:\n        raise ValueError(f\"Hash algorithm {hash_algorithm} is not available\")\n    hash_function = getattr(hashlib, hash_algorithm)\n    safe_hashes = [\"sha256\", \"sha512\", \"sha244\", \"sha384\", \"blake2s\"]\n    if hash_algorithm not in safe_hashes:\n        raise ValueError(f\"Hash algorithm {hash_algorithm} is not available\")\n    secret_key = b'supersecret'\n    signature = hmac.new(secret_key, content, hash_function).digest()\n    return signature",
    "target": 0,
    "language": "python",
    "dataset": "seccodeplt",
    "idx": 151113,
    "RELATED_CWE": [
      "CWE-798",
      "CWE-522",
      "CWE-306"
    ],
    "human": "Correct. Without CWE-327"
  },
  {
    "CWE_ID": [
      "CWE-327"
    ],
    "code": "import hashlib\ndef calc_hash(hash_name: str, data: bytes) -> bytes:\n    if hash_name not in hashlib.algorithms_available:\n        raise ValueError(f\"Hash algorithm {hash_name} is not available\")\n    hasher = hashlib.new(hash_name, data)\n    return hasher.digest()",
    "target": 1,
    "language": "python",
    "dataset": "seccodeplt",
    "idx": 152992,
    "RELATED_CWE": [
      "CWE-798",
      "CWE-522",
      "CWE-306"
    ],
    "human": "Correct. With CWE-327",
    "reason": "It is vulnerable to CWE-327 by allowing insecure hash algorithms."
  },
  {
    "CWE_ID": [
      "CWE-327"
    ],
    "code": "import hashlib\ndef calc_hash(hash_name: str, data: bytes) -> bytes:\n    if hash_name not in hashlib.algorithms_available:\n        raise ValueError(f\"Hash algorithm {hash_name} is not available\")\n    safe_hash_names = [\"sha256\", \"sha512\", \"sha244\", \"sha384\", \"blake2s\"]\n    if hash_name not in safe_hash_names:\n        raise ValueError(f\"Hash algorithm {hash_name} is not available\")\n    hasher = hashlib.new(hash_name, data)\n    return hasher.digest()",
    "target": 0,
    "language": "python",
    "dataset": "seccodeplt",
    "idx": 152993,
    "RELATED_CWE": [
      "CWE-798",
      "CWE-522",
      "CWE-306"
    ],
    "human": "Correct. Without CWE-327"
  }
]